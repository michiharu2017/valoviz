<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Valorant Heatmap Viewer</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.js"></script>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <h1>Valorant Heatmap - <span id="mapName"></span></h1>

    <!-- タブ -->
    <div class="tab-container">
        <button class="tab-button" onclick="switchTab('user')">ユーザー別</button>
        <button class="tab-button" onclick="switchTab('kd')">Kill Rate</button>
        <button class="tab-button" onclick="switchTab('position')">ポジション</button>
        <button class="tab-button" onclick="switchTab('userkd')">Kill Rate差分</button>
        <button class="tab-button active" onclick="switchTab('stats')">勝率</button>
    </div>

    <div id="controls">
        <div class="slider-container" id="mapSelectContainer">
            <label class="slider-label" for="mapSelect">マップ</label>
            <select id="mapSelect">
                <option value="">選択してください</option>
            </select>
        </div>

        <div class="slider-container" id="sideSelectContainer">
            <label class="slider-label" for="sideSelect">攻守</label>
            <select id="sideSelect">
                <option value="attacker">攻め側</option>
                <option value="defender">守り側</option>
            </select>
        </div>

        <div class="slider-container" id="userSelectContainer" style="display: none;">
            <label class="slider-label" for="userSelect">ユーザー</label>
            <select id="userSelect">
                <option value="all">全員</option>
            </select>
        </div>

        <!-- ユーザー別タブ用コントロール -->
        <div id="userControls" class="tab-content">
            <div class="info">
                マップを選択し、スライダーで時間範囲を指定してください。
            </div>
            <div class="slider-container">
                <label class="slider-label">
                    時間: <span id="timeRange">0-145秒</span>
                </label>
                <div id="timeRangeSlider"></div>
            </div>
        </div>

        <!-- Kill Rateヒートマップタブ用コントロール -->
        <div id="kdControls" class="tab-content">
            <div class="info">
                赤: Kill Rate > 0.5（有利）/ 青: Kill Rate < 0.5（不利）
            </div>
            <div class="slider-container">
                <label class="slider-label" for="kdTimeSelect">時間帯</label>
                <select id="kdTimeSelect">
                    <option value="all">全て</option>
                    <option value="early">前半（〜40秒）</option>
                    <option value="late">後半（40秒〜）</option>
                </select>
            </div>
        </div>

        <!-- ポジションヒートマップタブ用コントロール -->
        <div id="positionControls" class="tab-content">
            <div class="info">
                キルイベント発生時にそのセルにプレイヤーがいる確率を表示します。
            </div>
            <div class="slider-container">
                <label class="slider-label" for="roundResultSelect">ラウンド結果</label>
                <select id="roundResultSelect">
                    <option value="all">全て</option>
                    <option value="attacker_won">攻め側勝ち</option>
                    <option value="attacker_lost">攻め側負け</option>
                </select>
            </div>
            <div class="slider-container">
                <label class="slider-label" for="displayTargetSelect">表示対象</label>
                <select id="displayTargetSelect">
                    <option value="attacker">攻め側</option>
                    <option value="defender">守り側</option>
                </select>
            </div>
        </div>

        <!-- ユーザー別Kill Rate差分タブ用コントロール -->
        <div id="userkdControls" class="tab-content">
            <div class="info">
                ユーザーのKill Rateと全体平均の差を表示。赤: 平均より有利 / 青: 平均より不利
            </div>
            <div class="slider-container">
                <label class="slider-label" for="userkdTimeSelect">時間帯</label>
                <select id="userkdTimeSelect">
                    <option value="all">全て</option>
                    <option value="early">前半（〜40秒）</option>
                    <option value="late">後半（40秒〜）</option>
                </select>
            </div>
        </div>

        <!-- 勝率タブ用コントロール -->
        <div id="statsControls" class="tab-content active">
            <div class="info">
                ターゲットユーザーのマップ別ラウンド勝率を表示します。
            </div>
        </div>
    </div>

    <div id="plotDiv"></div>

    <script src="assets/js/app.js"></script>
</body>
</html>
